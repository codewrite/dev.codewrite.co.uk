<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>NRF24L01 on Raspberry Pi - Codewrite Dev Blog</title><meta name=description content="C#, Python, VueJS, C++ for Linux, Windows, Raspberry Pi and Arduino. Real Projects from a software engineer who is also an amateur radio enthusiast"><link rel=stylesheet href=/css/style.css><link rel=alternate type=application/rss+xml title="Codewrite Dev Blog" href=/index.xml></head><body><header class=site-header><div class="wrapper header-inner"><a class=site-title href=/>Codewrite Dev Blog</a><nav class=site-nav aria-label="Primary navigation"><input type=checkbox id=nav-trigger class=nav-trigger>
<label for=nav-trigger class=nav-toggle>Menu</label><ul class=nav-list id=nav-list><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/general/overview/>Overview</a></li></ul><button class=nav-toggle aria-controls=nav-list aria-expanded=false>Menu</button></nav></div></header><main class=page-content><div class=wrapper><nav class=breadcrumbs aria-label=Breadcrumbs><div class=breadcrumbs-inner><a href=/>Home</a>
<span class=sep>›</span>
<a href=/posts/>Posts</a>
<span class=sep>›</span>
<span class=current>NRF24L01 on Raspberry Pi</span></div></nav><div class=content-area><div class=main-column><article class=post><header class=post-header><h1 class=post-title>NRF24L01 on Raspberry Pi</h1></header><div class=post-content><p>OK, so just for the record, I&rsquo;ve tried using the NRF24L01 on the Raspberry Pi (via tha GPIO SPI pins) and I don&rsquo;t recommend it.</p><p>So the following is just a record of what I did, in case I ever change my mind :).</p><p><img src=/images/RPI-NRF24L01/wiring-photo.jpg alt="RPI NRF Board Wiring"></p><pre tabindex=0><code>NRF24L01 Side  Wire   Raspberry Pi Side
-------------  ----   -----------------
MISO           White   GPIO  9 (SPI_MISO)
SCK            Grey    GPIO 11 (SPI_SCLK)
CE             Orange  GPIO 25
GND            Black   GND     (PIN 20)
IRQ            Brown   GPIO 22
MOSI           Purple  GPIO 10 (SPI_MOSI)
CSN            Yellow  GPIO  8 (SPI_CE0)
VCC            Red     3.3V    (PIN 1)
</code></pre><p>The Raspberry Pi code consisted of two python files which had to be in the same folder:</p><details><summary>nrf24TestSend.py:</summary><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#60a0b0;font-style:italic>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>RPi.GPIO</span> <span style=color:#007020;font-weight:700>as</span> <span style=color:#0e84b5;font-weight:700>GPIO</span>  <span style=color:#60a0b0;font-style:italic># import gpio</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>time</span>      <span style=color:#60a0b0;font-style:italic>#import time library</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>spidev</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#007020;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>lib_nrf24</span> <span style=color:#007020;font-weight:700>import</span> NRF24   <span style=color:#60a0b0;font-style:italic>#import NRF24 library</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#60a0b0;font-style:italic># Loosely based on: https://circuitdigest.com/microcontroller-projects/wireless-rf-communication-between-arduino-and-raspberry-pi-using-nrf24l01</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>GPIO<span style=color:#666>.</span>setmode(GPIO<span style=color:#666>.</span>BCM)       <span style=color:#60a0b0;font-style:italic># set the gpio mode</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#60a0b0;font-style:italic># set the pipe address. this address shoeld be entered on the receiver alo</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>pipes <span style=color:#666>=</span> [[<span style=color:#40a070>0xE0</span>, <span style=color:#40a070>0xE0</span>, <span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xE0</span>], [<span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xF0</span>, <span style=color:#40a070>0xF0</span>, <span style=color:#40a070>0xE0</span>]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>radio <span style=color:#666>=</span> NRF24(GPIO, spidev<span style=color:#666>.</span>SpiDev())   <span style=color:#60a0b0;font-style:italic># use the gpio pins</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>radio<span style=color:#666>.</span>begin(<span style=color:#40a070>0</span>, <span style=color:#40a070>25</span>)   <span style=color:#60a0b0;font-style:italic># start the radio and set the ce,csn pin ce= GPIO08, csn= GPIO25</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>radio<span style=color:#666>.</span>setPayloadSize(<span style=color:#40a070>32</span>)  <span style=color:#60a0b0;font-style:italic>#set the payload size as 32 bytes</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>radio<span style=color:#666>.</span>setChannel(<span style=color:#40a070>0x76</span>) <span style=color:#60a0b0;font-style:italic># set the channel as 76 hex</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>radio<span style=color:#666>.</span>setDataRate(NRF24<span style=color:#666>.</span>BR_1MBPS)    <span style=color:#60a0b0;font-style:italic># set radio data rate</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>radio<span style=color:#666>.</span>setPALevel(NRF24<span style=color:#666>.</span>PA_MAX)  <span style=color:#60a0b0;font-style:italic># set PA level</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>radio<span style=color:#666>.</span>setAutoAck(<span style=color:#007020;font-weight:700>True</span>)       <span style=color:#60a0b0;font-style:italic># set acknowledgement as true </span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>radio<span style=color:#666>.</span>enableDynamicPayloads()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>radio<span style=color:#666>.</span>enableAckPayload()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>radio<span style=color:#666>.</span>openWritingPipe(pipes[<span style=color:#40a070>0</span>])     <span style=color:#60a0b0;font-style:italic># open the defined pipe for writing</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>radio<span style=color:#666>.</span>printDetails()      <span style=color:#60a0b0;font-style:italic># print basic detals of radio</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>sendMessage <span style=color:#666>=</span> <span style=color:#007020>list</span>(<span style=color:#4070a0>&#34;Hi..Arduino UNO&#34;</span>)  <span style=color:#60a0b0;font-style:italic>#the message to be sent</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span><span style=color:#007020;font-weight:700>while</span> <span style=color:#007020>len</span>(sendMessage) <span style=color:#666>&lt;</span> <span style=color:#40a070>32</span>:    
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>    sendMessage<span style=color:#666>.</span>append(<span style=color:#40a070>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style=color:#007020;font-weight:700>while</span> <span style=color:#007020;font-weight:700>True</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    start <span style=color:#666>=</span> time<span style=color:#666>.</span>time()      <span style=color:#60a0b0;font-style:italic>#start the time for checking delivery time</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>    radio<span style=color:#666>.</span>write(sendMessage)   <span style=color:#60a0b0;font-style:italic># just write the message to radio</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>    <span style=color:#007020>print</span>(<span style=color:#4070a0>&#34;Sent the message: </span><span style=color:#70a0d0>{}</span><span style=color:#4070a0>&#34;</span><span style=color:#666>.</span>format(sendMessage))  <span style=color:#60a0b0;font-style:italic># print a message after succesfull send</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>    radio<span style=color:#666>.</span>startListening()        <span style=color:#60a0b0;font-style:italic># Start listening the radio</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>    
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>    <span style=color:#007020;font-weight:700>while</span> <span style=color:#007020;font-weight:700>not</span> radio<span style=color:#666>.</span>available(<span style=color:#40a070>0</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>        time<span style=color:#666>.</span>sleep(<span style=color:#40a070>1</span><span style=color:#666>/</span><span style=color:#40a070>100</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>        <span style=color:#007020;font-weight:700>if</span> time<span style=color:#666>.</span>time() <span style=color:#666>-</span> start <span style=color:#666>&gt;</span> <span style=color:#40a070>2</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>            <span style=color:#007020>print</span>(<span style=color:#4070a0>&#34;Timed out.&#34;</span>)  <span style=color:#60a0b0;font-style:italic># print errror message if radio disconnected or not functioning anymore</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>            <span style=color:#007020;font-weight:700>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>    radio<span style=color:#666>.</span>stopListening()     <span style=color:#60a0b0;font-style:italic># close radio</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>    time<span style=color:#666>.</span>sleep(<span style=color:#40a070>3</span>)  <span style=color:#60a0b0;font-style:italic># give delay of 3 seconds</span>
</span></span></code></pre></div></details><details><summary>lib_nrf24.py:</summary><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#60a0b0;font-style:italic>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#60a0b0;font-style:italic># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#60a0b0;font-style:italic>#</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span><span style=color:#60a0b0;font-style:italic># This file lib_nrf24.py is a slightly tweaked version of Barraca&#39;s &#34;pynrf24&#34;.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span><span style=color:#60a0b0;font-style:italic># So this is my tweak for Raspberry Pi and &#34;Virtual GPIO&#34; ...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span><span style=color:#60a0b0;font-style:italic>#       ... of Barraca&#39;s port to BeagleBone python ...  (Joao Paulo Barraca &lt;jpbarraca@gmail.com&gt;)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span><span style=color:#60a0b0;font-style:italic>#                ... of maniacbug&#39;s NRF24L01 C++ library for Arduino.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span><span style=color:#60a0b0;font-style:italic># Brian Lavery Oct 2014</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span><span style=color:#60a0b0;font-style:italic>#    This program is free software: you can redistribute it and/or modify</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span><span style=color:#60a0b0;font-style:italic>#    it under the terms of the GNU General Public License as published by</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span><span style=color:#60a0b0;font-style:italic>#    the Free Software Foundation, either version 3 of the License, or</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span><span style=color:#60a0b0;font-style:italic>#    (at your option) any later version.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span><span style=color:#60a0b0;font-style:italic>#</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span><span style=color:#60a0b0;font-style:italic>#    This program is distributed in the hope that it will be useful,</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span><span style=color:#60a0b0;font-style:italic>#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span><span style=color:#60a0b0;font-style:italic>#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span><span style=color:#60a0b0;font-style:italic>#    GNU General Public License for more details.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span><span style=color:#60a0b0;font-style:italic>#</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>sys</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>time</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span><span style=color:#007020;font-weight:700>if</span> <span style=color:#bb60d5>__name__</span> <span style=color:#666>==</span> <span style=color:#4070a0>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>    <span style=color:#007020>print</span> (sys<span style=color:#666>.</span>argv[<span style=color:#40a070>0</span>], <span style=color:#4070a0>&#39;is an importable module:&#39;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>    <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;...  from&#34;</span>, sys<span style=color:#666>.</span>argv[<span style=color:#40a070>0</span>], <span style=color:#4070a0>&#34;import lib_nrf24&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>    <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>    exit()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span><span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>_BV</span>(x):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>    <span style=color:#007020;font-weight:700>return</span> <span style=color:#40a070>1</span> <span style=color:#666>&lt;&lt;</span> x
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span><span style=color:#007020;font-weight:700>class</span> <span style=color:#0e84b5;font-weight:700>NRF24</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>    MAX_CHANNEL <span style=color:#666>=</span> <span style=color:#40a070>127</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>    MAX_PAYLOAD_SIZE <span style=color:#666>=</span> <span style=color:#40a070>32</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>    <span style=color:#60a0b0;font-style:italic># PA Levels</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>    PA_MIN <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>    PA_LOW <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>    PA_HIGH <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>    PA_MAX <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>    PA_ERROR <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>    <span style=color:#60a0b0;font-style:italic># Bit rates</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>    BR_1MBPS <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>    BR_2MBPS <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>    BR_250KBPS <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>    <span style=color:#60a0b0;font-style:italic># CRC</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>    CRC_DISABLED <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>    CRC_8 <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>    CRC_16 <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>    CRC_ENABLED <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span>    <span style=color:#60a0b0;font-style:italic># Registers</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span>    CONFIG <span style=color:#666>=</span> <span style=color:#40a070>0x00</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>    EN_AA <span style=color:#666>=</span> <span style=color:#40a070>0x01</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>    EN_RXADDR <span style=color:#666>=</span> <span style=color:#40a070>0x02</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>    SETUP_AW <span style=color:#666>=</span> <span style=color:#40a070>0x03</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>    SETUP_RETR <span style=color:#666>=</span> <span style=color:#40a070>0x04</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>    RF_CH <span style=color:#666>=</span> <span style=color:#40a070>0x05</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>    RF_SETUP <span style=color:#666>=</span> <span style=color:#40a070>0x06</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>    STATUS <span style=color:#666>=</span> <span style=color:#40a070>0x07</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>    OBSERVE_TX <span style=color:#666>=</span> <span style=color:#40a070>0x08</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>    CD <span style=color:#666>=</span> <span style=color:#40a070>0x09</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>    RX_ADDR_P0 <span style=color:#666>=</span> <span style=color:#40a070>0x0A</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>    RX_ADDR_P1 <span style=color:#666>=</span> <span style=color:#40a070>0x0B</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>    RX_ADDR_P2 <span style=color:#666>=</span> <span style=color:#40a070>0x0C</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>    RX_ADDR_P3 <span style=color:#666>=</span> <span style=color:#40a070>0x0D</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>    RX_ADDR_P4 <span style=color:#666>=</span> <span style=color:#40a070>0x0E</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>    RX_ADDR_P5 <span style=color:#666>=</span> <span style=color:#40a070>0x0F</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>    TX_ADDR <span style=color:#666>=</span> <span style=color:#40a070>0x10</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>    RX_PW_P0 <span style=color:#666>=</span> <span style=color:#40a070>0x11</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>    RX_PW_P1 <span style=color:#666>=</span> <span style=color:#40a070>0x12</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>    RX_PW_P2 <span style=color:#666>=</span> <span style=color:#40a070>0x13</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>    RX_PW_P3 <span style=color:#666>=</span> <span style=color:#40a070>0x14</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>    RX_PW_P4 <span style=color:#666>=</span> <span style=color:#40a070>0x15</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>    RX_PW_P5 <span style=color:#666>=</span> <span style=color:#40a070>0x16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>    FIFO_STATUS <span style=color:#666>=</span> <span style=color:#40a070>0x17</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>    DYNPD <span style=color:#666>=</span> <span style=color:#40a070>0x1C</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>    FEATURE <span style=color:#666>=</span> <span style=color:#40a070>0x1D</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>    <span style=color:#60a0b0;font-style:italic># Bit Mnemonics */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>    MASK_RX_DR <span style=color:#666>=</span> <span style=color:#40a070>6</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>    MASK_TX_DS <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>    MASK_MAX_RT <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>    EN_CRC <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>    CRCO <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>    PWR_UP <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>    PRIM_RX <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>    ENAA_P5 <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span>    ENAA_P4 <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span>    ENAA_P3 <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>    ENAA_P2 <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>    ENAA_P1 <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>    ENAA_P0 <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>    ERX_P5 <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span>    ERX_P4 <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span>    ERX_P3 <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>    ERX_P2 <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span>    ERX_P1 <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>    ERX_P0 <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>    AW <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>    ARD <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>    ARC <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115</span><span>    PLL_LOCK <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116</span><span>    RF_DR <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117</span><span>    RF_PWR <span style=color:#666>=</span> <span style=color:#40a070>6</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118</span><span>    RX_DR <span style=color:#666>=</span> <span style=color:#40a070>6</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>    TX_DS <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>    MAX_RT <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>    RX_P_NO <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>    TX_FULL <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>    PLOS_CNT <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>    ARC_CNT <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>    TX_REUSE <span style=color:#666>=</span> <span style=color:#40a070>6</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126</span><span>    FIFO_FULL <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127</span><span>    TX_EMPTY <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128</span><span>    RX_FULL <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129</span><span>    RX_EMPTY <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130</span><span>    DPL_P5 <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131</span><span>    DPL_P4 <span style=color:#666>=</span> <span style=color:#40a070>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132</span><span>    DPL_P3 <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133</span><span>    DPL_P2 <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134</span><span>    DPL_P1 <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135</span><span>    DPL_P0 <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136</span><span>    EN_DPL <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137</span><span>    EN_ACK_PAY <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138</span><span>    EN_DYN_ACK <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140</span><span>    <span style=color:#60a0b0;font-style:italic># Instruction Mnemonics</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141</span><span>    R_REGISTER <span style=color:#666>=</span> <span style=color:#40a070>0x00</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142</span><span>    W_REGISTER <span style=color:#666>=</span> <span style=color:#40a070>0x20</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143</span><span>    REGISTER_MASK <span style=color:#666>=</span> <span style=color:#40a070>0x1F</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144</span><span>    ACTIVATE <span style=color:#666>=</span> <span style=color:#40a070>0x50</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145</span><span>    R_RX_PL_WID <span style=color:#666>=</span> <span style=color:#40a070>0x60</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146</span><span>    R_RX_PAYLOAD <span style=color:#666>=</span> <span style=color:#40a070>0x61</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147</span><span>    W_TX_PAYLOAD <span style=color:#666>=</span> <span style=color:#40a070>0xA0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148</span><span>    W_ACK_PAYLOAD <span style=color:#666>=</span> <span style=color:#40a070>0xA8</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149</span><span>    FLUSH_TX <span style=color:#666>=</span> <span style=color:#40a070>0xE1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150</span><span>    FLUSH_RX <span style=color:#666>=</span> <span style=color:#40a070>0xE2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151</span><span>    REUSE_TX_PL <span style=color:#666>=</span> <span style=color:#40a070>0xE3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152</span><span>    NOP <span style=color:#666>=</span> <span style=color:#40a070>0xFF</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155</span><span>    <span style=color:#60a0b0;font-style:italic># Non-P omissions</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156</span><span>    LNA_HCURR <span style=color:#666>=</span> <span style=color:#40a070>0x00</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158</span><span>    <span style=color:#60a0b0;font-style:italic># P model memory Map</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159</span><span>    RPD <span style=color:#666>=</span> <span style=color:#40a070>0x09</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161</span><span>    <span style=color:#60a0b0;font-style:italic># P model bit Mnemonics</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162</span><span>    RF_DR_LOW <span style=color:#666>=</span> <span style=color:#40a070>5</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163</span><span>    RF_DR_HIGH <span style=color:#666>=</span> <span style=color:#40a070>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164</span><span>    RF_PWR_LOW <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165</span><span>    RF_PWR_HIGH <span style=color:#666>=</span> <span style=color:#40a070>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167</span><span>    <span style=color:#60a0b0;font-style:italic># Signal Mnemonics</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168</span><span>    LOW <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169</span><span>    HIGH <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171</span><span>    datarate_e_str_P <span style=color:#666>=</span> [<span style=color:#4070a0>&#34;1MBPS&#34;</span>, <span style=color:#4070a0>&#34;2MBPS&#34;</span>, <span style=color:#4070a0>&#34;250KBPS&#34;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172</span><span>    model_e_str_P <span style=color:#666>=</span> [<span style=color:#4070a0>&#34;nRF24L01&#34;</span>, <span style=color:#4070a0>&#34;nRF24l01+&#34;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173</span><span>    crclength_e_str_P <span style=color:#666>=</span> [<span style=color:#4070a0>&#34;Disabled&#34;</span>, <span style=color:#4070a0>&#34;8 bits&#34;</span>, <span style=color:#4070a0>&#34;16 bits&#34;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174</span><span>    pa_dbm_e_str_P <span style=color:#666>=</span> [<span style=color:#4070a0>&#34;PA_MIN&#34;</span>, <span style=color:#4070a0>&#34;PA_LOW&#34;</span>, <span style=color:#4070a0>&#34;PA_MED&#34;</span>, <span style=color:#4070a0>&#34;PA_HIGH&#34;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175</span><span>    child_pipe <span style=color:#666>=</span> [RX_ADDR_P0, RX_ADDR_P1, RX_ADDR_P2, RX_ADDR_P3, RX_ADDR_P4, RX_ADDR_P5]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177</span><span>    child_payload_size <span style=color:#666>=</span> [RX_PW_P0, RX_PW_P1, RX_PW_P2, RX_PW_P3, RX_PW_P4, RX_PW_P5]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178</span><span>    child_pipe_enable <span style=color:#666>=</span> [ERX_P0, ERX_P1, ERX_P2, ERX_P3, ERX_P4, ERX_P5]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180</span><span>    GPIO <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>None</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181</span><span>    spidev <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>None</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>__init__</span>(<span style=color:#007020>self</span>, gpio, spidev):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184</span><span>        <span style=color:#60a0b0;font-style:italic># It should be possible to instantiate multiple objects, with different GPIO / spidev</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185</span><span>        <span style=color:#60a0b0;font-style:italic># EG on Raspberry, one could be RPI GPIO &amp; spidev module, other could be virtual-GPIO</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186</span><span>        <span style=color:#60a0b0;font-style:italic># On rpi, only bus 0 is supported here, not bus 1 of the model B plus</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO <span style=color:#666>=</span> gpio   <span style=color:#60a0b0;font-style:italic># the GPIO module</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>spidev <span style=color:#666>=</span> spidev <span style=color:#60a0b0;font-style:italic># the spidev object/instance</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>channel <span style=color:#666>=</span> <span style=color:#40a070>76</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>data_rate <span style=color:#666>=</span> NRF24<span style=color:#666>.</span>BR_1MBPS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span> <span style=color:#60a0b0;font-style:italic># 2Mbs data rate in use?</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>p_variant <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span> <span style=color:#60a0b0;font-style:italic># False for RF24L01 and true for RF24L01P (nrf24l01+)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size <span style=color:#666>=</span> <span style=color:#40a070>5</span> <span style=color:#60a0b0;font-style:italic>#*&lt; Fixed size of payloads</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">194</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_available <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span> <span style=color:#60a0b0;font-style:italic>#*&lt; Whether there is an ack payload waiting</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">195</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>dynamic_payloads_enabled <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span> <span style=color:#60a0b0;font-style:italic>#*&lt; Whether dynamic payloads are enabled.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">196</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_length <span style=color:#666>=</span> <span style=color:#40a070>5</span> <span style=color:#60a0b0;font-style:italic>#*&lt; Dynamic size of pending ack payload.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">197</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>pipe0_reading_address <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>None</span> <span style=color:#60a0b0;font-style:italic>#*&lt; Last address set on pipe 0 for reading.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">198</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">199</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>ce</span>(<span style=color:#007020>self</span>, level):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">200</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin <span style=color:#666>==</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">201</span><span>            <span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">202</span><span>        <span style=color:#60a0b0;font-style:italic># rf24-CE is optional. Tie to HIGH if not used. (Altho, left floating seems to read HIGH anyway??? - risky!)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">203</span><span>        <span style=color:#60a0b0;font-style:italic># Some RF24 modes may NEED control over CE.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">204</span><span>        <span style=color:#60a0b0;font-style:italic># non-powerdown, fixed PTX or RTX role, dynamic payload size &amp; ack-payload:    does NOT need CE.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">205</span><span>        <span style=color:#007020;font-weight:700>if</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>HIGH:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">206</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>output(<span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin, <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>HIGH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">207</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">208</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>output(<span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin, <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>LOW)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">209</span><span>        <span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">210</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">211</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">212</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">213</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>read_register</span>(<span style=color:#007020>self</span>, reg, blen<span style=color:#666>=</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">214</span><span>        buf <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>R_REGISTER <span style=color:#666>|</span> ( NRF24<span style=color:#666>.</span>REGISTER_MASK <span style=color:#666>&amp;</span> reg )]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">215</span><span>        <span style=color:#007020;font-weight:700>for</span> col <span style=color:#007020;font-weight:700>in</span> <span style=color:#007020>range</span>(blen):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">216</span><span>            buf<span style=color:#666>.</span>append(NRF24<span style=color:#666>.</span>NOP)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">217</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">218</span><span>        resp <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(buf)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">219</span><span>        <span style=color:#007020;font-weight:700>if</span> blen <span style=color:#666>==</span> <span style=color:#40a070>1</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">220</span><span>            <span style=color:#007020;font-weight:700>return</span> resp[<span style=color:#40a070>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">221</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">222</span><span>        <span style=color:#007020;font-weight:700>return</span> resp[<span style=color:#40a070>1</span>:blen <span style=color:#666>+</span> <span style=color:#40a070>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">223</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">224</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>write_register</span>(<span style=color:#007020>self</span>, reg, value, length<span style=color:#666>=-</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">225</span><span>        buf <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>W_REGISTER <span style=color:#666>|</span> ( NRF24<span style=color:#666>.</span>REGISTER_MASK <span style=color:#666>&amp;</span> reg )]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">226</span><span>        <span style=color:#60a0b0;font-style:italic>###if isinstance(value, (int, long)):   # ng for python3. but value should never be long anyway</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">227</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>isinstance</span>(value, <span style=color:#007020>int</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">228</span><span>            <span style=color:#007020;font-weight:700>if</span> length <span style=color:#666>&lt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">229</span><span>                length <span style=color:#666>=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">230</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">231</span><span>            length <span style=color:#666>=</span> <span style=color:#007020>min</span>(<span style=color:#40a070>4</span>, length)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">232</span><span>            <span style=color:#007020;font-weight:700>for</span> i <span style=color:#007020;font-weight:700>in</span> <span style=color:#007020>range</span>(length):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">233</span><span>                buf<span style=color:#666>.</span>insert(<span style=color:#40a070>1</span>, <span style=color:#007020>int</span>(value <span style=color:#666>&amp;</span> <span style=color:#40a070>0xff</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">234</span><span>                value <span style=color:#666>&gt;&gt;=</span> <span style=color:#40a070>8</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">235</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">236</span><span>        <span style=color:#007020;font-weight:700>elif</span> <span style=color:#007020>isinstance</span>(value, <span style=color:#007020>list</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">237</span><span>            <span style=color:#007020;font-weight:700>if</span> length <span style=color:#666>&lt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">238</span><span>                length <span style=color:#666>=</span> <span style=color:#007020>len</span>(value)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">239</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">240</span><span>            <span style=color:#007020;font-weight:700>for</span> i <span style=color:#007020;font-weight:700>in</span> <span style=color:#007020>range</span>(<span style=color:#007020>min</span>(<span style=color:#007020>len</span>(value), length)):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">241</span><span>                buf<span style=color:#666>.</span>append(<span style=color:#007020>int</span>(value[<span style=color:#007020>len</span>(value) <span style=color:#666>-</span> i <span style=color:#666>-</span> <span style=color:#40a070>1</span>] <span style=color:#666>&amp;</span> <span style=color:#40a070>0xff</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">242</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">243</span><span>            <span style=color:#007020;font-weight:700>raise</span> <span style=color:#007020>Exception</span>(<span style=color:#4070a0>&#34;Value must be int or list&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">244</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">245</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(buf)[<span style=color:#40a070>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">246</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">247</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">248</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>write_payload</span>(<span style=color:#007020>self</span>, buf):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">249</span><span>        data_len <span style=color:#666>=</span> <span style=color:#007020>min</span>(<span style=color:#007020>self</span><span style=color:#666>.</span>payload_size, <span style=color:#007020>len</span>(buf))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">250</span><span>        blank_len <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">251</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020;font-weight:700>not</span> <span style=color:#007020>self</span><span style=color:#666>.</span>dynamic_payloads_enabled:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">252</span><span>            blank_len <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size <span style=color:#666>-</span> data_len
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">253</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">254</span><span>        txbuffer <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>W_TX_PAYLOAD]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">255</span><span>        <span style=color:#007020;font-weight:700>for</span> n <span style=color:#007020;font-weight:700>in</span> buf:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">256</span><span>            t <span style=color:#666>=</span> <span style=color:#007020>type</span>(n)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">257</span><span>            <span style=color:#007020;font-weight:700>if</span> t <span style=color:#007020;font-weight:700>is</span> <span style=color:#007020>str</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">258</span><span>                txbuffer<span style=color:#666>.</span>append(<span style=color:#007020>ord</span>(n))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">259</span><span>            <span style=color:#007020;font-weight:700>elif</span> t <span style=color:#007020;font-weight:700>is</span> <span style=color:#007020>int</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">260</span><span>                txbuffer<span style=color:#666>.</span>append(n)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">261</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">262</span><span>                <span style=color:#007020;font-weight:700>raise</span> <span style=color:#007020>Exception</span>(<span style=color:#4070a0>&#34;Only ints and chars are supported: Found &#34;</span> <span style=color:#666>+</span> <span style=color:#007020>str</span>(t))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">263</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">264</span><span>        <span style=color:#007020;font-weight:700>if</span> blank_len <span style=color:#666>!=</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">265</span><span>            blank <span style=color:#666>=</span> [<span style=color:#40a070>0x00</span> <span style=color:#007020;font-weight:700>for</span> i <span style=color:#007020;font-weight:700>in</span> <span style=color:#007020>range</span>(blank_len)]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">266</span><span>            txbuffer<span style=color:#666>.</span>extend(blank)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">267</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">268</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(txbuffer)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">269</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">270</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>read_payload</span>(<span style=color:#007020>self</span>, buf, buf_len<span style=color:#666>=-</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">271</span><span>        <span style=color:#007020;font-weight:700>if</span> buf_len <span style=color:#666>&lt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">272</span><span>            buf_len <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">273</span><span>        data_len <span style=color:#666>=</span> <span style=color:#007020>min</span>(<span style=color:#007020>self</span><span style=color:#666>.</span>payload_size, buf_len)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">274</span><span>        blank_len <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">275</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020;font-weight:700>not</span> <span style=color:#007020>self</span><span style=color:#666>.</span>dynamic_payloads_enabled:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">276</span><span>            blank_len <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size <span style=color:#666>-</span> data_len
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">277</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">278</span><span>        txbuffer <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>NOP <span style=color:#007020;font-weight:700>for</span> i <span style=color:#007020;font-weight:700>in</span> <span style=color:#007020>range</span>(<span style=color:#40a070>0</span>, blank_len <span style=color:#666>+</span> data_len <span style=color:#666>+</span> <span style=color:#40a070>1</span>)]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">279</span><span>        txbuffer[<span style=color:#40a070>0</span>] <span style=color:#666>=</span> NRF24<span style=color:#666>.</span>R_RX_PAYLOAD
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">280</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">281</span><span>        payload <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(txbuffer)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">282</span><span>        <span style=color:#007020;font-weight:700>del</span> buf[:]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">283</span><span>        buf<span style=color:#666>.</span>extend(payload[<span style=color:#40a070>1</span>:data_len <span style=color:#666>+</span> <span style=color:#40a070>1</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">284</span><span>        <span style=color:#007020;font-weight:700>return</span> data_len
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">285</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">286</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>flush_rx</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">287</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2([NRF24<span style=color:#666>.</span>FLUSH_RX])[<span style=color:#40a070>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">288</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">289</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>flush_tx</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">290</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2([NRF24<span style=color:#666>.</span>FLUSH_TX])[<span style=color:#40a070>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">291</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">292</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>get_status</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">293</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2([NRF24<span style=color:#666>.</span>NOP])[<span style=color:#40a070>0</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">294</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">295</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>print_status</span>(<span style=color:#007020>self</span>, status):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">296</span><span>        status_str <span style=color:#666>=</span> <span style=color:#4070a0>&#34;STATUS</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0> = 0x</span><span style=color:#70a0d0>{0:02x}</span><span style=color:#4070a0> RX_DR=</span><span style=color:#70a0d0>{1:x}</span><span style=color:#4070a0> TX_DS=</span><span style=color:#70a0d0>{2:x}</span><span style=color:#4070a0> MAX_RT=</span><span style=color:#70a0d0>{3:x}</span><span style=color:#4070a0> RX_P_NO=</span><span style=color:#70a0d0>{4:x}</span><span style=color:#4070a0> TX_FULL=</span><span style=color:#70a0d0>{5:x}</span><span style=color:#4070a0>&#34;</span><span style=color:#666>.</span>format(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">297</span><span>            status,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">298</span><span>            <span style=color:#40a070>1</span> <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>RX_DR) <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">299</span><span>            <span style=color:#40a070>1</span> <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>TX_DS) <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">300</span><span>            <span style=color:#40a070>1</span> <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT) <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">301</span><span>            ((status <span style=color:#666>&gt;&gt;</span> NRF24<span style=color:#666>.</span>RX_P_NO) <span style=color:#666>&amp;</span> <span style=color:#40a070>7</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">302</span><span>            <span style=color:#40a070>1</span> <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>TX_FULL) <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">303</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">304</span><span>        <span style=color:#007020>print</span> (status_str)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">305</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">306</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>print_observe_tx</span>(<span style=color:#007020>self</span>, value):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">307</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;Observe Tx: </span><span style=color:#70a0d0>%02x</span><span style=color:#4070a0>   Lost Pkts: </span><span style=color:#70a0d0>%d</span><span style=color:#4070a0>    Retries: </span><span style=color:#70a0d0>%d</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> (value, value <span style=color:#666>&gt;&gt;</span> NRF24<span style=color:#666>.</span>PLOS_CNT, value <span style=color:#666>&amp;</span> <span style=color:#40a070>15</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">308</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">309</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">310</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>print_byte_register</span>(<span style=color:#007020>self</span>, name, reg, qty<span style=color:#666>=</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">311</span><span>        extra_tab <span style=color:#666>=</span> <span style=color:#4070a0>&#39;</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0>&#39;</span> <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>len</span>(name) <span style=color:#666>&lt;</span> <span style=color:#40a070>8</span> <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">312</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;</span><span style=color:#70a0d0>%s</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#70a0d0>%c</span><span style=color:#4070a0> =&#34;</span> <span style=color:#666>%</span> (name, extra_tab)),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">313</span><span>        <span style=color:#007020;font-weight:700>while</span> qty <span style=color:#666>&gt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">314</span><span>            <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;0x</span><span style=color:#70a0d0>%02x</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> (<span style=color:#007020>self</span><span style=color:#666>.</span>read_register(reg))),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">315</span><span>            qty <span style=color:#666>-=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">316</span><span>            reg <span style=color:#666>+=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">317</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">318</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">319</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">320</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>print_address_register</span>(<span style=color:#007020>self</span>, name, reg, qty<span style=color:#666>=</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">321</span><span>        extra_tab <span style=color:#666>=</span> <span style=color:#4070a0>&#39;</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0>&#39;</span> <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>len</span>(name) <span style=color:#666>&lt;</span> <span style=color:#40a070>8</span> <span style=color:#007020;font-weight:700>else</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">322</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;</span><span style=color:#70a0d0>%s</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#70a0d0>%c</span><span style=color:#4070a0> =&#34;</span> <span style=color:#666>%</span> (name, extra_tab)),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">323</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">324</span><span>        <span style=color:#007020;font-weight:700>while</span> qty <span style=color:#666>&gt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">325</span><span>            qty <span style=color:#666>-=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">326</span><span>            buf <span style=color:#666>=</span> <span style=color:#007020>reversed</span>(<span style=color:#007020>self</span><span style=color:#666>.</span>read_register(reg, <span style=color:#40a070>5</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">327</span><span>            reg <span style=color:#666>+=</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">328</span><span>            sys<span style=color:#666>.</span>stdout<span style=color:#666>.</span>write(<span style=color:#4070a0>&#34; 0x&#34;</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">329</span><span>            <span style=color:#007020;font-weight:700>for</span> i <span style=color:#007020;font-weight:700>in</span> buf:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">330</span><span>                sys<span style=color:#666>.</span>stdout<span style=color:#666>.</span>write(<span style=color:#4070a0>&#34;</span><span style=color:#70a0d0>%02x</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> i)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">331</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">332</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">333</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">334</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">335</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setChannel</span>(<span style=color:#007020>self</span>, channel):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">336</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>channel <span style=color:#666>=</span> <span style=color:#007020>min</span>(<span style=color:#007020>max</span>(<span style=color:#40a070>0</span>, channel), NRF24<span style=color:#666>.</span>MAX_CHANNEL)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">337</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>RF_CH, <span style=color:#007020>self</span><span style=color:#666>.</span>channel)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">338</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">339</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getChannel</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">340</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_CH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">341</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">342</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setPayloadSize</span>(<span style=color:#007020>self</span>, size):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">343</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size <span style=color:#666>=</span> <span style=color:#007020>min</span>(<span style=color:#007020>max</span>(size, <span style=color:#40a070>1</span>), NRF24<span style=color:#666>.</span>MAX_PAYLOAD_SIZE)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">344</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">345</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getPayloadSize</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">346</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">347</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">348</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>printDetails</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">349</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_status(<span style=color:#007020>self</span><span style=color:#666>.</span>get_status())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">350</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_address_register(<span style=color:#4070a0>&#34;RX_ADDR_P0-1&#34;</span>, NRF24<span style=color:#666>.</span>RX_ADDR_P0, <span style=color:#40a070>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">351</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;RX_ADDR_P2-5&#34;</span>, NRF24<span style=color:#666>.</span>RX_ADDR_P2, <span style=color:#40a070>4</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">352</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_address_register(<span style=color:#4070a0>&#34;TX_ADDR&#34;</span>, NRF24<span style=color:#666>.</span>TX_ADDR)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">353</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">354</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;RX_PW_P0-6&#34;</span>, NRF24<span style=color:#666>.</span>RX_PW_P0, <span style=color:#40a070>6</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">355</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;EN_AA&#34;</span>, NRF24<span style=color:#666>.</span>EN_AA)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">356</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;EN_RXADDR&#34;</span>, NRF24<span style=color:#666>.</span>EN_RXADDR)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">357</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;RF_CH&#34;</span>, NRF24<span style=color:#666>.</span>RF_CH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">358</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;RF_SETUP&#34;</span>, NRF24<span style=color:#666>.</span>RF_SETUP)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">359</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;CONFIG&#34;</span>, NRF24<span style=color:#666>.</span>CONFIG)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">360</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>print_byte_register(<span style=color:#4070a0>&#34;DYNPD/FEATURE&#34;</span>, NRF24<span style=color:#666>.</span>DYNPD, <span style=color:#40a070>2</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">361</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">362</span><span>        <span style=color:#60a0b0;font-style:italic>#</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">363</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;Data Rate</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0> = </span><span style=color:#70a0d0>%s</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> NRF24<span style=color:#666>.</span>datarate_e_str_P[<span style=color:#007020>self</span><span style=color:#666>.</span>getDataRate()])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">364</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;Model</span><span style=color:#4070a0;font-weight:700>\t\t</span><span style=color:#4070a0> = </span><span style=color:#70a0d0>%s</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> NRF24<span style=color:#666>.</span>model_e_str_P[<span style=color:#007020>self</span><span style=color:#666>.</span>isPVariant()])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">365</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;CRC Length</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0> = </span><span style=color:#70a0d0>%s</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> NRF24<span style=color:#666>.</span>crclength_e_str_P[<span style=color:#007020>self</span><span style=color:#666>.</span>getCRCLength()])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">366</span><span>        <span style=color:#007020>print</span> (<span style=color:#4070a0>&#34;PA Power</span><span style=color:#4070a0;font-weight:700>\t</span><span style=color:#4070a0> = </span><span style=color:#70a0d0>%s</span><span style=color:#4070a0>&#34;</span> <span style=color:#666>%</span> NRF24<span style=color:#666>.</span>pa_dbm_e_str_P[<span style=color:#007020>self</span><span style=color:#666>.</span>getPALevel()])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">367</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">368</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>begin</span>(<span style=color:#007020>self</span>, csn_pin, ce_pin<span style=color:#666>=</span><span style=color:#40a070>0</span>):   <span style=color:#60a0b0;font-style:italic># csn &amp; ce are RF24 terminology. csn = SPI&#39;s CE!</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">369</span><span>        <span style=color:#60a0b0;font-style:italic># Initialize SPI bus..</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">370</span><span>        <span style=color:#60a0b0;font-style:italic># ce_pin is for the rx=listen or tx=trigger pin on RF24 (they call that ce !!!)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">371</span><span>        <span style=color:#60a0b0;font-style:italic># CE optional (at least in some circumstances, eg fixed PTX PRX roles, no powerdown)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">372</span><span>        <span style=color:#60a0b0;font-style:italic># CE seems to hold itself as (sufficiently) HIGH, but tie HIGH is safer!</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">373</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>open(<span style=color:#40a070>0</span>, csn_pin)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">374</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin <span style=color:#666>=</span> ce_pin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">375</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">376</span><span>        <span style=color:#007020;font-weight:700>if</span> ce_pin:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">377</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>setup(<span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin, <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>OUT)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">378</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">379</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>max_speed_hz <span style=color:#666>=</span> <span style=color:#40a070>8000000</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">380</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">381</span><span>        time<span style=color:#666>.</span>sleep(<span style=color:#40a070>5</span> <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">382</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">383</span><span>        <span style=color:#60a0b0;font-style:italic># Set 1500uS (minimum for 32B payload in ESB@250KBPS) timeouts, to make testing a little easier</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">384</span><span>        <span style=color:#60a0b0;font-style:italic># WARNING: If this is ever lowered, either 250KBS mode with AA is broken or maximum packet</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">385</span><span>        <span style=color:#60a0b0;font-style:italic># sizes must never be used. See documentation for a more complete explanation.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">386</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>SETUP_RETR, (<span style=color:#40a070>0b0100</span> <span style=color:#666>&lt;&lt;</span> NRF24<span style=color:#666>.</span>ARD) <span style=color:#666>|</span> <span style=color:#40a070>0b1111</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">387</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">388</span><span>        <span style=color:#60a0b0;font-style:italic># Restore our default PA level</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">389</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>setPALevel(NRF24<span style=color:#666>.</span>PA_MAX)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">390</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">391</span><span>        <span style=color:#60a0b0;font-style:italic># Determine if this is a p or non-p RF24 module and then</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">392</span><span>        <span style=color:#60a0b0;font-style:italic># reset our data rate back to default value. This works</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">393</span><span>        <span style=color:#60a0b0;font-style:italic># because a non-P variant won&#39;t allow the data rate to</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">394</span><span>        <span style=color:#60a0b0;font-style:italic># be set to 250Kbps.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">395</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>setDataRate(NRF24<span style=color:#666>.</span>BR_250KBPS):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">396</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>p_variant <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">397</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">398</span><span>        <span style=color:#60a0b0;font-style:italic># Then set the data rate to the slowest (and most reliable) speed supported by all</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">399</span><span>        <span style=color:#60a0b0;font-style:italic># hardware.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">400</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>setDataRate(NRF24<span style=color:#666>.</span>BR_1MBPS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">401</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">402</span><span>        <span style=color:#60a0b0;font-style:italic># Initialize CRC and request 2-byte (16bit) CRC</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">403</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>setCRCLength(NRF24<span style=color:#666>.</span>CRC_16)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">404</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">405</span><span>        <span style=color:#60a0b0;font-style:italic># Disable dynamic payloads, to match dynamic_payloads_enabled setting</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">406</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>DYNPD, <span style=color:#40a070>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">407</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">408</span><span>        <span style=color:#60a0b0;font-style:italic># Reset current status</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">409</span><span>        <span style=color:#60a0b0;font-style:italic># Notice reset and flush is the last thing we do</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">410</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>STATUS, _BV(NRF24<span style=color:#666>.</span>RX_DR) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>TX_DS) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">411</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">412</span><span>        <span style=color:#60a0b0;font-style:italic># Set up default configuration.  Callers can always change it later.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">413</span><span>        <span style=color:#60a0b0;font-style:italic># This channel should be universally safe and not bleed over into adjacent</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">414</span><span>        <span style=color:#60a0b0;font-style:italic># spectrum.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">415</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>setChannel(<span style=color:#007020>self</span><span style=color:#666>.</span>channel)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">416</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">417</span><span>        <span style=color:#60a0b0;font-style:italic># Flush buffers</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">418</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>flush_rx()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">419</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>flush_tx()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">420</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">421</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>end</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">422</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">423</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>close()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">424</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>spidev <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>None</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">425</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">426</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>startListening</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">427</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>PWR_UP) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>PRIM_RX))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">428</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>STATUS, _BV(NRF24<span style=color:#666>.</span>RX_DR) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>TX_DS) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">429</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">430</span><span>        <span style=color:#60a0b0;font-style:italic># Restore the pipe0 address, if exists</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">431</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>pipe0_reading_address:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">432</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(<span style=color:#007020>self</span><span style=color:#666>.</span>RX_ADDR_P0, <span style=color:#007020>self</span><span style=color:#666>.</span>pipe0_reading_address, <span style=color:#40a070>5</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">433</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">434</span><span>        <span style=color:#60a0b0;font-style:italic># Go!</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">435</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ce(NRF24<span style=color:#666>.</span>HIGH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">436</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">437</span><span>        <span style=color:#60a0b0;font-style:italic># wait for the radio to come up (130us actually only needed)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">438</span><span>        time<span style=color:#666>.</span>sleep(<span style=color:#40a070>130</span> <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">439</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">440</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>stopListening</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">441</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ce(NRF24<span style=color:#666>.</span>LOW)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">442</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>flush_tx()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">443</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>flush_rx()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">444</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">445</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>powerDown</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">446</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>&amp;</span> <span style=color:#666>~</span>_BV(NRF24<span style=color:#666>.</span>PWR_UP))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">447</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">448</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>powerUp</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">449</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>PWR_UP))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">450</span><span>        time<span style=color:#666>.</span>sleep(<span style=color:#40a070>150</span> <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">451</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">452</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>write</span>(<span style=color:#007020>self</span>, buf):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">453</span><span>        <span style=color:#60a0b0;font-style:italic># Begin the write</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">454</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>startWrite(buf)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">455</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">456</span><span>        timeout <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>getMaxTimeout() <span style=color:#60a0b0;font-style:italic>#s to wait for timeout</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">457</span><span>        sent_at <span style=color:#666>=</span> time<span style=color:#666>.</span>time()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">458</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">459</span><span>        <span style=color:#007020;font-weight:700>while</span> <span style=color:#007020;font-weight:700>True</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">460</span><span>            <span style=color:#60a0b0;font-style:italic>#status = self.read_register(NRF24.OBSERVE_TX, 1)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">461</span><span>            status <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>get_status()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">462</span><span>            <span style=color:#007020;font-weight:700>if</span> (status <span style=color:#666>&amp;</span> (_BV(NRF24<span style=color:#666>.</span>TX_DS) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT))) <span style=color:#007020;font-weight:700>or</span> (time<span style=color:#666>.</span>time() <span style=color:#666>-</span> sent_at <span style=color:#666>&gt;</span> timeout ):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">463</span><span>                <span style=color:#007020;font-weight:700>break</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">464</span><span>            time<span style=color:#666>.</span>sleep(<span style=color:#40a070>10</span> <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">465</span><span>        <span style=color:#60a0b0;font-style:italic>#obs = self.read_register(NRF24.OBSERVE_TX)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">466</span><span>        <span style=color:#60a0b0;font-style:italic>#self.print_observe_tx(obs)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">467</span><span>        <span style=color:#60a0b0;font-style:italic>#self.print_status(status)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">468</span><span>        <span style=color:#60a0b0;font-style:italic># (for debugging)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">469</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">470</span><span>        what <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>whatHappened()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">471</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">472</span><span>        result <span style=color:#666>=</span> what[<span style=color:#4070a0>&#39;tx_ok&#39;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">473</span><span>        <span style=color:#007020;font-weight:700>if</span> what[<span style=color:#4070a0>&#39;tx_fail&#39;</span>]:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">474</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>flush_tx();    <span style=color:#60a0b0;font-style:italic># bl  - dont jam up the fifo</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">475</span><span>        <span style=color:#60a0b0;font-style:italic># Handle the ack packet</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">476</span><span>        <span style=color:#007020;font-weight:700>if</span> what[<span style=color:#4070a0>&#39;rx_ready&#39;</span>]:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">477</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_length <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>getDynamicPayloadSize()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">478</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_available <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>              <span style=color:#60a0b0;font-style:italic>## bl</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">479</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">480</span><span>        <span style=color:#007020;font-weight:700>return</span> result
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">481</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">482</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>startWrite</span>(<span style=color:#007020>self</span>, buf):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">483</span><span>        <span style=color:#60a0b0;font-style:italic># Transmitter power-up</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">484</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, (<span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>PWR_UP) ) <span style=color:#666>&amp;</span> <span style=color:#666>~</span>_BV(NRF24<span style=color:#666>.</span>PRIM_RX))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">485</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">486</span><span>        <span style=color:#60a0b0;font-style:italic># Send the payload</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">487</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_payload(buf)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">488</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">489</span><span>        <span style=color:#60a0b0;font-style:italic># Allons!</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">490</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">491</span><span>            <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>RPI_REVISION <span style=color:#666>&gt;</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">492</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>ce(<span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>HIGH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">493</span><span>                time<span style=color:#666>.</span>sleep(<span style=color:#40a070>10</span> <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">494</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>ce(<span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>LOW)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">495</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">496</span><span>                <span style=color:#60a0b0;font-style:italic># virtGPIO is slower. A 10 uSec pulse is better done with pulseOut():</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">497</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>pulseOut(<span style=color:#007020>self</span><span style=color:#666>.</span>ce_pin, <span style=color:#007020>self</span><span style=color:#666>.</span>GPIO<span style=color:#666>.</span>HIGH, <span style=color:#40a070>10</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">498</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">499</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">500</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">501</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getDynamicPayloadSize</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">502</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2([NRF24<span style=color:#666>.</span>R_RX_PL_WID, NRF24<span style=color:#666>.</span>NOP])[<span style=color:#40a070>1</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">503</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">504</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>available</span>(<span style=color:#007020>self</span>, pipe_num<span style=color:#666>=</span><span style=color:#007020;font-weight:700>None</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">505</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020;font-weight:700>not</span> pipe_num:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">506</span><span>            pipe_num <span style=color:#666>=</span> []
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">507</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">508</span><span>        status <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>get_status()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">509</span><span>        result <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">510</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">511</span><span>        <span style=color:#60a0b0;font-style:italic># Sometimes the radio specifies that there is data in one pipe but</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">512</span><span>        <span style=color:#60a0b0;font-style:italic># doesn&#39;t set the RX flag...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">513</span><span>        <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>RX_DR) <span style=color:#007020;font-weight:700>or</span> (status <span style=color:#666>&amp;</span> <span style=color:#40a070>0b00001110</span> <span style=color:#666>!=</span> <span style=color:#40a070>0b00001110</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">514</span><span>            result <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">515</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">516</span><span>        <span style=color:#007020;font-weight:700>if</span> result:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">517</span><span>            <span style=color:#60a0b0;font-style:italic># If the caller wants the pipe number, include that</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">518</span><span>            <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>len</span>(pipe_num) <span style=color:#666>&gt;=</span> <span style=color:#40a070>1</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">519</span><span>                pipe_num[<span style=color:#40a070>0</span>] <span style=color:#666>=</span> ( status <span style=color:#666>&gt;&gt;</span> NRF24<span style=color:#666>.</span>RX_P_NO ) <span style=color:#666>&amp;</span> <span style=color:#40a070>0b00000111</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">520</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">521</span><span>                <span style=color:#60a0b0;font-style:italic># Clear the status bit</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">522</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">523</span><span>                <span style=color:#60a0b0;font-style:italic># ??? Should this REALLY be cleared now?  Or wait until we</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">524</span><span>                <span style=color:#60a0b0;font-style:italic># actually READ the payload?</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">525</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>STATUS, _BV(NRF24<span style=color:#666>.</span>RX_DR))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">526</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">527</span><span>        <span style=color:#60a0b0;font-style:italic># Handle ack payload receipt</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">528</span><span>        <span style=color:#007020;font-weight:700>if</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>TX_DS):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">529</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>STATUS, _BV(NRF24<span style=color:#666>.</span>TX_DS))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">530</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">531</span><span>        <span style=color:#007020;font-weight:700>return</span> result
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">532</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">533</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>read</span>(<span style=color:#007020>self</span>, buf, buf_len<span style=color:#666>=-</span><span style=color:#40a070>1</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">534</span><span>        <span style=color:#60a0b0;font-style:italic># Fetch the payload</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">535</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>read_payload(buf, buf_len)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">536</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">537</span><span>        <span style=color:#60a0b0;font-style:italic># was this the last of the data available?</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">538</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FIFO_STATUS) <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>RX_EMPTY)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">539</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">540</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>whatHappened</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">541</span><span>        <span style=color:#60a0b0;font-style:italic># Read the status &amp; reset the status in one easy call</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">542</span><span>        <span style=color:#60a0b0;font-style:italic># Or is that such a good idea?</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">543</span><span>        status <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>STATUS, _BV(NRF24<span style=color:#666>.</span>RX_DR) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>TX_DS) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">544</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">545</span><span>        <span style=color:#60a0b0;font-style:italic># Report to the user what happened</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">546</span><span>        tx_ok <span style=color:#666>=</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>TX_DS)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">547</span><span>        tx_fail <span style=color:#666>=</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>MAX_RT)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">548</span><span>        rx_ready <span style=color:#666>=</span> status <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>RX_DR)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">549</span><span>        <span style=color:#007020;font-weight:700>return</span> {<span style=color:#4070a0>&#39;tx_ok&#39;</span>: tx_ok, <span style=color:#4070a0>&#34;tx_fail&#34;</span>: tx_fail, <span style=color:#4070a0>&#34;rx_ready&#34;</span>: rx_ready}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">550</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">551</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>openWritingPipe</span>(<span style=color:#007020>self</span>, value):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">552</span><span>        <span style=color:#60a0b0;font-style:italic># Note that the NRF24L01(+)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">553</span><span>        <span style=color:#60a0b0;font-style:italic># expects it LSB first.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">554</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">555</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>RX_ADDR_P0, value, <span style=color:#40a070>5</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">556</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>TX_ADDR, value, <span style=color:#40a070>5</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">557</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">558</span><span>        max_payload_size <span style=color:#666>=</span> <span style=color:#40a070>32</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">559</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>RX_PW_P0, <span style=color:#007020>min</span>(<span style=color:#007020>self</span><span style=color:#666>.</span>payload_size, max_payload_size))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">560</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">561</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>openReadingPipe</span>(<span style=color:#007020>self</span>, child, address):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">562</span><span>        <span style=color:#60a0b0;font-style:italic># If this is pipe 0, cache the address.  This is needed because</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">563</span><span>        <span style=color:#60a0b0;font-style:italic># openWritingPipe() will overwrite the pipe 0 address, so</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">564</span><span>        <span style=color:#60a0b0;font-style:italic># startListening() will have to restore it.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">565</span><span>        <span style=color:#007020;font-weight:700>if</span> child <span style=color:#666>==</span> <span style=color:#40a070>0</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">566</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>pipe0_reading_address <span style=color:#666>=</span> address
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">567</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">568</span><span>        <span style=color:#007020;font-weight:700>if</span> child <span style=color:#666>&lt;=</span> <span style=color:#40a070>6</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">569</span><span>            <span style=color:#60a0b0;font-style:italic># For pipes 2-5, only write the LSB</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">570</span><span>            <span style=color:#007020;font-weight:700>if</span> child <span style=color:#666>&lt;</span> <span style=color:#40a070>2</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">571</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>child_pipe[child], address, <span style=color:#40a070>5</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">572</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">573</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>child_pipe[child], address, <span style=color:#40a070>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">574</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">575</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>child_payload_size[child], <span style=color:#007020>self</span><span style=color:#666>.</span>payload_size)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">576</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">577</span><span>            <span style=color:#60a0b0;font-style:italic># Note it would be more efficient to set all of the bits for all open</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">578</span><span>            <span style=color:#60a0b0;font-style:italic># pipes at once.  However, I thought it would make the calling code</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">579</span><span>            <span style=color:#60a0b0;font-style:italic># more simple to do it this way.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">580</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>EN_RXADDR,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">581</span><span>                                <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>EN_RXADDR) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>child_pipe_enable[child]))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">582</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">583</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">584</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>closeReadingPipe</span>(<span style=color:#007020>self</span>, pipe):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">585</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>EN_RXADDR,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">586</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(EN_RXADDR) <span style=color:#666>&amp;</span> <span style=color:#666>~</span>_BV(NRF24<span style=color:#666>.</span>child_pipe_enable[pipe]))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">587</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">588</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">589</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>toggle_features</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">590</span><span>        buf <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>ACTIVATE, <span style=color:#40a070>0x73</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">591</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(buf)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">592</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">593</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>enableDynamicPayloads</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">594</span><span>        <span style=color:#60a0b0;font-style:italic># Enable dynamic payload throughout the system</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">595</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>FEATURE, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_DPL))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">596</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">597</span><span>        <span style=color:#60a0b0;font-style:italic># If it didn&#39;t work, the features are not enabled</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">598</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020;font-weight:700>not</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">599</span><span>            <span style=color:#60a0b0;font-style:italic># So enable them and try again</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">600</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>toggle_features()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">601</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>FEATURE, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_DPL))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">602</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">603</span><span>        <span style=color:#60a0b0;font-style:italic># Enable dynamic payload on all pipes</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">604</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">605</span><span>        <span style=color:#60a0b0;font-style:italic># Not sure the use case of only having dynamic payload on certain</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">606</span><span>        <span style=color:#60a0b0;font-style:italic># pipes, so the library does not support it.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">607</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>DYNPD, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>DYNPD) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P5) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P4) <span style=color:#666>|</span> _BV(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">608</span><span>            NRF24<span style=color:#666>.</span>DPL_P3) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P2) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P1) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P0))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">609</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">610</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>dynamic_payloads_enabled <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">611</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">612</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">613</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>enableAckPayload</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">614</span><span>        <span style=color:#60a0b0;font-style:italic># enable ack payload and dynamic payload features</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">615</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>FEATURE,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">616</span><span>                            <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_ACK_PAY) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_DPL))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">617</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">618</span><span>        <span style=color:#60a0b0;font-style:italic># If it didn&#39;t work, the features are not enabled</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">619</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020;font-weight:700>not</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">620</span><span>            <span style=color:#60a0b0;font-style:italic># So enable them and try again</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">621</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>toggle_features()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">622</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>FEATURE,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">623</span><span>                                <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>FEATURE) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_ACK_PAY) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_DPL))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">624</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">625</span><span>        <span style=color:#60a0b0;font-style:italic># Enable dynamic payload on pipes 0 &amp; 1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">626</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>DYNPD, <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>DYNPD) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P1) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>DPL_P0))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">627</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">628</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>writeAckPayload</span>(<span style=color:#007020>self</span>, pipe, buf, buf_len):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">629</span><span>        txbuffer <span style=color:#666>=</span> [NRF24<span style=color:#666>.</span>W_ACK_PAYLOAD <span style=color:#666>|</span> ( pipe <span style=color:#666>&amp;</span> <span style=color:#40a070>0x7</span> )]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">630</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">631</span><span>        max_payload_size <span style=color:#666>=</span> <span style=color:#40a070>32</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">632</span><span>        data_len <span style=color:#666>=</span> <span style=color:#007020>min</span>(buf_len, max_payload_size)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">633</span><span>        txbuffer<span style=color:#666>.</span>extend(buf[<span style=color:#40a070>0</span>:data_len])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">634</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">635</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>spidev<span style=color:#666>.</span>xfer2(txbuffer)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">636</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">637</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>isAckPayloadAvailable</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">638</span><span>        result <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_available
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">639</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>ack_payload_available <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">640</span><span>        <span style=color:#007020;font-weight:700>return</span> result
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">641</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">642</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>isPVariant</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">643</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>p_variant
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">644</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">645</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setAutoAck</span>(<span style=color:#007020>self</span>, enable):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">646</span><span>        <span style=color:#007020;font-weight:700>if</span> enable:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">647</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>EN_AA, <span style=color:#40a070>0b111111</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">648</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">649</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>EN_AA, <span style=color:#40a070>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">650</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">651</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setAutoAckPipe</span>(<span style=color:#007020>self</span>, pipe, enable):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">652</span><span>        <span style=color:#007020;font-weight:700>if</span> pipe <span style=color:#666>&lt;=</span> <span style=color:#40a070>6</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">653</span><span>            en_aa <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>EN_AA)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">654</span><span>            <span style=color:#007020;font-weight:700>if</span> enable:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">655</span><span>                en_aa <span style=color:#666>|=</span> _BV(pipe)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">656</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">657</span><span>                en_aa <span style=color:#666>&amp;=</span> <span style=color:#666>~</span>_BV(pipe)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">658</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">659</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>EN_AA, en_aa)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">660</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">661</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>testCarrier</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">662</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CD) <span style=color:#666>&amp;</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">663</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">664</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>testRPD</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">665</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RPD) <span style=color:#666>&amp;</span> <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">666</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">667</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setPALevel</span>(<span style=color:#007020>self</span>, level):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">668</span><span>        setup <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_SETUP)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">669</span><span>        setup <span style=color:#666>&amp;=</span> <span style=color:#666>~</span>( _BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">670</span><span>        <span style=color:#60a0b0;font-style:italic># switch uses RAM (evil!)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">671</span><span>        <span style=color:#007020;font-weight:700>if</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>PA_MAX:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">672</span><span>            setup <span style=color:#666>|=</span> (_BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">673</span><span>        <span style=color:#007020;font-weight:700>elif</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>PA_HIGH:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">674</span><span>            setup <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">675</span><span>        <span style=color:#007020;font-weight:700>elif</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>PA_LOW:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">676</span><span>            setup <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">677</span><span>        <span style=color:#007020;font-weight:700>elif</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>PA_MIN:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">678</span><span>            nop <span style=color:#666>=</span> <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">679</span><span>        <span style=color:#007020;font-weight:700>elif</span> level <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>PA_ERROR:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">680</span><span>            <span style=color:#60a0b0;font-style:italic># On error, go to maximum PA</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">681</span><span>            setup <span style=color:#666>|=</span> (_BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">682</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">683</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>RF_SETUP, setup)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">684</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">685</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">686</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getPALevel</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">687</span><span>        power <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_SETUP) <span style=color:#666>&amp;</span> (_BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">688</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">689</span><span>        <span style=color:#007020;font-weight:700>if</span> power <span style=color:#666>==</span> (_BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH)):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">690</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>PA_MAX
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">691</span><span>        <span style=color:#007020;font-weight:700>elif</span> power <span style=color:#666>==</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_HIGH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">692</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>PA_HIGH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">693</span><span>        <span style=color:#007020;font-weight:700>elif</span> power <span style=color:#666>==</span> _BV(NRF24<span style=color:#666>.</span>RF_PWR_LOW):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">694</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>PA_LOW
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">695</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">696</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>PA_MIN
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">697</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">698</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setDataRate</span>(<span style=color:#007020>self</span>, speed):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">699</span><span>        result <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">700</span><span>        setup <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_SETUP)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">701</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">702</span><span>        <span style=color:#60a0b0;font-style:italic># HIGH and LOW &#39;00&#39; is 1Mbs - our default</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">703</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">704</span><span>        setup <span style=color:#666>&amp;=</span> <span style=color:#666>~</span>(_BV(NRF24<span style=color:#666>.</span>RF_DR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">705</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">706</span><span>        <span style=color:#007020;font-weight:700>if</span> speed <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>BR_250KBPS:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">707</span><span>            <span style=color:#60a0b0;font-style:italic># Must set the RF_DR_LOW to 1 RF_DR_HIGH (used to be RF_DR) is already 0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">708</span><span>            <span style=color:#60a0b0;font-style:italic># Making it &#39;10&#39;.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">709</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">710</span><span>            setup <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_LOW)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">711</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">712</span><span>            <span style=color:#60a0b0;font-style:italic># Set 2Mbs, RF_DR (RF_DR_HIGH) is set 1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">713</span><span>            <span style=color:#60a0b0;font-style:italic># Making it &#39;01&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">714</span><span>            <span style=color:#007020;font-weight:700>if</span> speed <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>BR_2MBPS:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">715</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">716</span><span>                setup <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_HIGH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">717</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">718</span><span>                <span style=color:#60a0b0;font-style:italic># 1Mbs</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">719</span><span>                <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">720</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">721</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>RF_SETUP, setup)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">722</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">723</span><span>        <span style=color:#60a0b0;font-style:italic># Verify our result</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">724</span><span>        <span style=color:#007020;font-weight:700>if</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_SETUP) <span style=color:#666>==</span> setup:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">725</span><span>            result <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">726</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">727</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>wide_band <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>False</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">728</span><span>        <span style=color:#007020;font-weight:700>return</span> result
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">729</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">730</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getDataRate</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">731</span><span>        dr <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>RF_SETUP) <span style=color:#666>&amp;</span> (_BV(NRF24<span style=color:#666>.</span>RF_DR_LOW) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_HIGH))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">732</span><span>        <span style=color:#60a0b0;font-style:italic># Order matters in our case below</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">733</span><span>        <span style=color:#007020;font-weight:700>if</span> dr <span style=color:#666>==</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_LOW):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">734</span><span>            <span style=color:#60a0b0;font-style:italic># &#39;10&#39; = 250KBPS</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">735</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>BR_250KBPS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">736</span><span>        <span style=color:#007020;font-weight:700>elif</span> dr <span style=color:#666>==</span> _BV(NRF24<span style=color:#666>.</span>RF_DR_HIGH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">737</span><span>            <span style=color:#60a0b0;font-style:italic># &#39;01&#39; = 2MBPS</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">738</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>BR_2MBPS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">739</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">740</span><span>            <span style=color:#60a0b0;font-style:italic># &#39;00&#39; = 1MBPS</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">741</span><span>            <span style=color:#007020;font-weight:700>return</span> NRF24<span style=color:#666>.</span>BR_1MBPS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">742</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">743</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">744</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setCRCLength</span>(<span style=color:#007020>self</span>, length):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">745</span><span>        config <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>&amp;</span> <span style=color:#666>~</span>( _BV(NRF24<span style=color:#666>.</span>CRC_16) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>CRC_ENABLED))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">746</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">747</span><span>        <span style=color:#007020;font-weight:700>if</span> length <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>CRC_DISABLED:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">748</span><span>            <span style=color:#60a0b0;font-style:italic># Do nothing, we turned it off above.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">749</span><span>            <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, config)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">750</span><span>            <span style=color:#007020;font-weight:700>return</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">751</span><span>        <span style=color:#007020;font-weight:700>elif</span> length <span style=color:#666>==</span> NRF24<span style=color:#666>.</span>CRC_8:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">752</span><span>            config <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>CRC_ENABLED)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">753</span><span>            config <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>CRC_8)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">754</span><span>        <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">755</span><span>            config <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>CRC_ENABLED)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">756</span><span>            config <span style=color:#666>|=</span> _BV(NRF24<span style=color:#666>.</span>CRC_16)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">757</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">758</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, config)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">759</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">760</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getCRCLength</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">761</span><span>        result <span style=color:#666>=</span> NRF24<span style=color:#666>.</span>CRC_DISABLED
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">762</span><span>        config <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>&amp;</span> ( _BV(NRF24<span style=color:#666>.</span>CRCO) <span style=color:#666>|</span> _BV(NRF24<span style=color:#666>.</span>EN_CRC))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">763</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">764</span><span>        <span style=color:#007020;font-weight:700>if</span> config <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>EN_CRC):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">765</span><span>            <span style=color:#007020;font-weight:700>if</span> config <span style=color:#666>&amp;</span> _BV(NRF24<span style=color:#666>.</span>CRCO):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">766</span><span>                result <span style=color:#666>=</span> NRF24<span style=color:#666>.</span>CRC_16
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">767</span><span>            <span style=color:#007020;font-weight:700>else</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">768</span><span>                result <span style=color:#666>=</span> NRF24<span style=color:#666>.</span>CRC_8
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">769</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">770</span><span>        <span style=color:#007020;font-weight:700>return</span> result
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">771</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">772</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>disableCRC</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">773</span><span>        disable <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>CONFIG) <span style=color:#666>&amp;</span> <span style=color:#666>~</span>_BV(NRF24<span style=color:#666>.</span>EN_CRC)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">774</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>CONFIG, disable)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">775</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">776</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>setRetries</span>(<span style=color:#007020>self</span>, delay, count):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">777</span><span>        <span style=color:#60a0b0;font-style:italic># see specs. Delay code below 5 can conflict with some ACK lengths</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">778</span><span>        <span style=color:#60a0b0;font-style:italic># and count should be set = 0 for non-ACK modes</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">779</span><span>        <span style=color:#007020>self</span><span style=color:#666>.</span>write_register(NRF24<span style=color:#666>.</span>SETUP_RETR, (delay <span style=color:#666>&amp;</span> <span style=color:#40a070>0xf</span>) <span style=color:#666>&lt;&lt;</span> NRF24<span style=color:#666>.</span>ARD <span style=color:#666>|</span> (count <span style=color:#666>&amp;</span> <span style=color:#40a070>0xf</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">780</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">781</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getRetries</span>(<span style=color:#007020>self</span>):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">782</span><span>        <span style=color:#007020;font-weight:700>return</span> <span style=color:#007020>self</span><span style=color:#666>.</span>read_register(NRF24<span style=color:#666>.</span>SETUP_RETR)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">783</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">784</span><span>    <span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>getMaxTimeout</span>(<span style=color:#007020>self</span>):        <span style=color:#60a0b0;font-style:italic># seconds</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">785</span><span>        retries <span style=color:#666>=</span> <span style=color:#007020>self</span><span style=color:#666>.</span>getRetries()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">786</span><span>        tout <span style=color:#666>=</span> (((<span style=color:#40a070>250</span><span style=color:#666>+</span>(<span style=color:#40a070>250</span><span style=color:#666>*</span>((retries<span style=color:#666>&amp;</span> <span style=color:#40a070>0xf0</span>)<span style=color:#666>&gt;&gt;</span><span style=color:#40a070>4</span> ))) <span style=color:#666>*</span> (retries <span style=color:#666>&amp;</span> <span style=color:#40a070>0x0f</span>)) <span style=color:#666>/</span> <span style=color:#40a070>1000000.0</span> <span style=color:#666>*</span> <span style=color:#40a070>2</span>) <span style=color:#666>+</span> <span style=color:#40a070>0.008</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">787</span><span>        <span style=color:#60a0b0;font-style:italic># Fudged up to about double Barraca&#39;s calculation</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">788</span><span>        <span style=color:#60a0b0;font-style:italic># Was too short &amp; was timeing out wrongly.    BL</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">789</span><span>        <span style=color:#007020;font-weight:700>return</span> tout
</span></span></code></pre></div></details><br><p>On an Arduino Nano, I had this code:</p><details><summary>NRF24L01.ino:</summary><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#007020>#include</span><span style=color:#007020>&lt;SPI.h&gt;</span><span style=color:#007020>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#007020>#include</span><span style=color:#007020>&lt;RF24.h&gt;</span><span style=color:#007020>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#60a0b0;font-style:italic>// Loosely based on: https://circuitdigest.com/microcontroller-projects/wireless-rf-communication-between-arduino-and-raspberry-pi-using-nrf24l01
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>RF24 <span style=color:#06287e>radio</span>(<span style=color:#40a070>7</span>, <span style=color:#40a070>8</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#902000>int</span> count <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#902000>unsigned</span> <span style=color:#902000>long</span> lastTime <span style=color:#666>=</span> <span style=color:#40a070>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#902000>void</span> <span style=color:#06287e>setup</span>()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  <span style=color:#06287e>pinMode</span>(<span style=color:#40a070>2</span>, OUTPUT);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  <span style=color:#06287e>pinMode</span>(<span style=color:#40a070>3</span>, OUTPUT);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  <span style=color:#06287e>pinMode</span>(<span style=color:#40a070>4</span>, OUTPUT);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>  <span style=color:#60a0b0;font-style:italic>//while (!Serial);
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>  Serial.<span style=color:#06287e>begin</span>(<span style=color:#40a070>9600</span>) ;     <span style=color:#60a0b0;font-style:italic>// start serial monitor baud rate
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>  radio.<span style=color:#06287e>begin</span>();        
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>  radio.<span style=color:#06287e>setPALevel</span>(RF24_PA_MIN);   
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  radio.<span style=color:#06287e>setChannel</span>(<span style=color:#40a070>0x76</span>);            
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  radio.<span style=color:#06287e>setPayloadSize</span>(<span style=color:#40a070>15</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>  <span style=color:#007020;font-weight:700>const</span> <span style=color:#902000>uint64_t</span> pipe <span style=color:#666>=</span> <span style=color:#40a070>0xE0E0F1F1E0LL</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>  radio.<span style=color:#06287e>openReadingPipe</span>(<span style=color:#40a070>0</span>, pipe);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>  <span style=color:#60a0b0;font-style:italic>//radio.enableDynamicPayloads();
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>  radio.<span style=color:#06287e>powerUp</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>  radio.<span style=color:#06287e>startListening</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#902000>void</span> <span style=color:#06287e>loop</span>()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>  <span style=color:#902000>bool</span> msgReceived <span style=color:#666>=</span> <span style=color:#007020>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>  <span style=color:#06287e>digitalWrite</span>(<span style=color:#40a070>2</span>, count <span style=color:#666>&amp;</span> <span style=color:#40a070>1</span> <span style=color:#666>?</span> <span style=color:#002070;font-weight:700>HIGH</span> : LOW);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>  <span style=color:#06287e>digitalWrite</span>(<span style=color:#40a070>3</span>, count <span style=color:#666>&amp;</span> <span style=color:#40a070>2</span> <span style=color:#666>?</span> <span style=color:#002070;font-weight:700>HIGH</span> : LOW);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>  <span style=color:#06287e>digitalWrite</span>(<span style=color:#40a070>4</span>, count <span style=color:#666>&amp;</span> <span style=color:#40a070>4</span> <span style=color:#666>?</span> <span style=color:#002070;font-weight:700>HIGH</span> : LOW);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>  <span style=color:#007020;font-weight:700>while</span> (lastTime <span style=color:#666>+</span> <span style=color:#40a070>4000</span> <span style=color:#666>&gt;</span> <span style=color:#06287e>millis</span>())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>  {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>    <span style=color:#007020;font-weight:700>if</span> (radio.<span style=color:#06287e>available</span>())
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>      <span style=color:#902000>char</span> receivedMessage[<span style=color:#40a070>32</span>] <span style=color:#666>=</span> {<span style=color:#40a070>0</span>} ;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>      radio.<span style=color:#06287e>read</span>(receivedMessage, <span style=color:#007020;font-weight:700>sizeof</span>(receivedMessage));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>      radio.<span style=color:#06287e>stopListening</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>      radio.<span style=color:#06287e>startListening</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>      Serial.<span style=color:#06287e>println</span>(receivedMessage);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>      msgReceived <span style=color:#666>=</span> <span style=color:#007020>true</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>  <span style=color:#007020;font-weight:700>if</span> (<span style=color:#666>!</span>msgReceived)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>    Serial.<span style=color:#06287e>println</span>(<span style=color:#4070a0>&#34;No message received &#34;</span> <span style=color:#666>+</span> <span style=color:#06287e>String</span>(count));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>  
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>  lastTime <span style=color:#666>=</span> <span style=color:#06287e>millis</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>  count<span style=color:#666>++</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>}
</span></span></code></pre></div></details><details><summary>Arduino Nano Photos:</summary><p><img src=/images/RPI-NRF24L01/ArduinoNano1.jpg alt="RPI NRF Board Wiring">
<img src=/images/RPI-NRF24L01/ArduinoNano2.jpg alt="RPI NRF Board Wiring">
<img src=/images/RPI-NRF24L01/ArduinoNano3.jpg alt="RPI NRF Board Wiring"></p></details><p><br>Because the Nano is 5V, I used a <a href="https://www.google.com/search?q=nrf24l01+adapter+module">NRF24L01 adapter module</a>.</p><p>It did work, but I wanted to use C# and .Net and the NRF24L01 driver in the dotnet iot project didn&rsquo;t work without modification:</p><details><summary>.Net Code (using dotnet iot library):</summary><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cs data-lang=cs><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System.Text</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System.Threading</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System.Device.Gpio</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System.Device.Spi</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>Iot.Device.Nrf24l01</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span><span style=color:#007020;font-weight:700>using</span> <span style=color:#0e84b5;font-weight:700>System.Collections.Generic</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span><span style=color:#60a0b0;font-style:italic>// See https://github.com/dotnet/iot for System.Device.Gpio source code and help</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span><span style=color:#007020;font-weight:700>namespace</span> <span style=color:#0e84b5;font-weight:700>RF24Lib</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>    <span style=color:#60a0b0;background-color:#fff0f0>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span>    <span style=color:#60a0b0;background-color:#fff0f0>/// Control NRF24L01 board</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>    <span style=color:#60a0b0;background-color:#fff0f0>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>    <span style=color:#007020;font-weight:700>public</span> <span style=color:#007020;font-weight:700>class</span> <span style=color:#0e84b5;font-weight:700>RF24Controller</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>        <span style=color:#007020;font-weight:700>private</span> SpiDevice senderDevice;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>        <span style=color:#007020;font-weight:700>private</span> GpioController _controller;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>        <span style=color:#007020;font-weight:700>private</span> <span style=color:#902000>bool</span> _disposed = <span style=color:#007020;font-weight:700>false</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>        <span style=color:#007020;font-weight:700>public</span> RF24Controller(GpioController controller)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>            _controller = controller;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span>        <span style=color:#007020;font-weight:700>public</span> <span style=color:#007020;font-weight:700>void</span> Initialize()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>            <span style=color:#60a0b0;font-style:italic>// SPI0 CS0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>            SpiConnectionSettings senderSettings = <span style=color:#007020;font-weight:700>new</span> SpiConnectionSettings(<span style=color:#40a070>0</span>, <span style=color:#40a070>0</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span>                ClockFrequency = Nrf24l01.SpiClockFrequency,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>                Mode = Nrf24l01.SpiMode
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>            };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>            senderDevice = SpiDevice.Create(senderSettings);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>        <span style=color:#007020;font-weight:700>public</span> <span style=color:#007020;font-weight:700>void</span> SendMessage(<span style=color:#902000>string</span> msg)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>            <span style=color:#60a0b0;font-style:italic>// SPI Device, CE Pin, IRQ Pin, Receive Packet Size</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>            <span style=color:#60a0b0;font-style:italic>//using (Nrf24l01 sender = new Nrf24l01(senderDevice, 25, 22, 32, 0x76, OutputPower.N18dBm, DataRate.Rate1Mbps)) //, PinNumberingScheme.Logical, _controller, false))</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>            Nrf24l01 sender = <span style=color:#007020;font-weight:700>new</span> Nrf24l01(senderDevice, <span style=color:#40a070>25</span>, <span style=color:#40a070>22</span>, <span style=color:#40a070>15</span>, <span style=color:#40a070>0x76</span>, OutputPower.N18dBm, DataRate.Rate1Mbps);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>            <span style=color:#902000>var</span> addr = <span style=color:#007020;font-weight:700>new</span> <span style=color:#902000>byte</span>[] { <span style=color:#40a070>0xE0</span>, <span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xF1</span>, <span style=color:#40a070>0xE0</span>, <span style=color:#40a070>0xE0</span> };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>            sender.Address = addr; <span style=color:#60a0b0;font-style:italic>//Encoding.UTF8.GetBytes(&#34;NRF24&#34;);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>            WriteRegister(<span style=color:#40a070>0</span>, (<span style=color:#902000>byte</span>)(ReadRegister(<span style=color:#40a070>0</span>)[<span style=color:#40a070>0</span>] | <span style=color:#40a070>0x04</span>));        <span style=color:#60a0b0;font-style:italic>// Set CRC to 2 bytes rather than 1 byte</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>            WriteRegister(<span style=color:#40a070>0x1c</span>, <span style=color:#40a070>0x3f</span>);  <span style=color:#60a0b0;font-style:italic>// Set dynamic payload for all pipes</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>            WriteRegister(<span style=color:#40a070>0x1d</span>, <span style=color:#40a070>0x04</span>);  <span style=color:#60a0b0;font-style:italic>// enable dynamic payload, disable payload with ACK, disable W_TX_PAYLOAD_NOACK command</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>            <span style=color:#902000>var</span> sendStr = <span style=color:#007020;font-weight:700>new</span> <span style=color:#902000>string</span>[] { <span style=color:#4070a0>&#34;test12345678901&#34;</span>, <span style=color:#4070a0>&#34;long string----&#34;</span>, <span style=color:#4070a0>&#34;short----------&#34;</span>, <span style=color:#4070a0>&#34;longer---------&#34;</span>, <span style=color:#4070a0>&#34;10 chars..-----&#34;</span>, <span style=color:#4070a0>&#34;four-----------&#34;</span> };   <span style=color:#60a0b0;font-style:italic>// 11 chars max</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>            <span style=color:#007020;font-weight:700>for</span> (<span style=color:#902000>int</span> i = <span style=color:#40a070>0</span>; i &lt; <span style=color:#40a070>6</span>; i++)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>                DisplayRegisters();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>                <span style=color:#60a0b0;font-style:italic>// Set sender send address</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span>                <span style=color:#60a0b0;font-style:italic>//sender.Send(Encoding.UTF8.GetBytes(&#34;Hello! .NET Core IoT&#34;));</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>                sender.Send(Encoding.UTF8.GetBytes(sendStr[i]));
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>                Thread.Sleep(<span style=color:#40a070>1000</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span>        <span style=color:#007020;font-weight:700>internal</span> <span style=color:#902000>byte</span>[] ReadRegister(<span style=color:#902000>byte</span> register, <span style=color:#902000>int</span> len = <span style=color:#40a070>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; writeBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>1</span> + len];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; readBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>1</span> + len];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>            writeBuf[<span style=color:#40a070>0</span>] = (<span style=color:#902000>byte</span>)(register);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span>            senderDevice.TransferFullDuplex(writeBuf, readBuf);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>            <span style=color:#007020;font-weight:700>return</span> readBuf.Slice(<span style=color:#40a070>1</span>).ToArray();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>        <span style=color:#007020;font-weight:700>internal</span> <span style=color:#007020;font-weight:700>void</span> WriteRegister(<span style=color:#902000>byte</span> register, <span style=color:#902000>byte</span> data)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; writeBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>2</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>                (<span style=color:#902000>byte</span>)(<span style=color:#40a070>0x20</span> + (<span style=color:#902000>byte</span>)register),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>                data
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>            };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; readBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>2</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>            senderDevice.TransferFullDuplex(writeBuf, readBuf);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>        <span style=color:#007020;font-weight:700>public</span> <span style=color:#007020;font-weight:700>void</span> DisplayRegisters()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>            <span style=color:#902000>var</span> registers = <span style=color:#007020;font-weight:700>new</span> List&lt;<span style=color:#902000>byte</span>&gt;();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; writeBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>1</span> + <span style=color:#40a070>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>            Span&lt;<span style=color:#902000>byte</span>&gt; readBuf = <span style=color:#007020;font-weight:700>stackalloc</span> <span style=color:#902000>byte</span>[<span style=color:#40a070>1</span> + <span style=color:#40a070>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>            <span style=color:#007020;font-weight:700>for</span> (<span style=color:#902000>int</span> reg = <span style=color:#40a070>0</span>; reg &lt;= <span style=color:#40a070>0x1d</span>; reg++)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>                <span style=color:#007020;font-weight:700>if</span> (reg &gt; <span style=color:#40a070>0x17</span> &amp;&amp; reg &lt; <span style=color:#40a070>0x1c</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>                {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>                    registers.Add(<span style=color:#40a070>0</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>                }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>                <span style=color:#007020;font-weight:700>else</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span>                {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span>                    registers.Add(ReadRegister((<span style=color:#902000>byte</span>)reg)[<span style=color:#40a070>0</span>]);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>                }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>            <span style=color:#902000>var</span> status = registers[<span style=color:#40a070>7</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span>            <span style=color:#902000>var</span> statStr = <span style=color:#4070a0>$&#34;RX_DR={((status &amp; 0x40) != 0 ? 1 : 0)} TX_DS={((status &amp; 0x20) != 0 ? 1 : 0)} MAX_RT={((status &amp; 0x10) != 0 ? 1 : 0)}&#34;</span> +
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span>                          <span style=color:#4070a0>$&#34;RX_P_NO={status &amp; 0x0e &gt;&gt; 1} TX_FULL={((status &amp; 0x01) != 0 ? 1 : 0)}&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;STATUS = 0x{status:x2} {statStr}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>            <span style=color:#60a0b0;font-style:italic>// Get RX and TX addresses</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>            <span style=color:#902000>var</span> txAddrRaw = ReadRegister(<span style=color:#40a070>0x10</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>            <span style=color:#902000>var</span> rxAddrP0Raw = ReadRegister(<span style=color:#40a070>0x0a</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>            <span style=color:#902000>var</span> rxAddrP1Raw = ReadRegister(<span style=color:#40a070>0x0b</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115</span><span>            <span style=color:#902000>var</span> rxAddrP2Raw = ReadRegister(<span style=color:#40a070>0x0c</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116</span><span>            <span style=color:#902000>var</span> rxAddrP3Raw = ReadRegister(<span style=color:#40a070>0x0d</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117</span><span>            <span style=color:#902000>var</span> rxAddrP4Raw = ReadRegister(<span style=color:#40a070>0x0e</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118</span><span>            <span style=color:#902000>var</span> rxAddrP5Raw = ReadRegister(<span style=color:#40a070>0x0f</span>, <span style=color:#40a070>5</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>            <span style=color:#902000>long</span> txAddr = GetAddrFromRaw(txAddrRaw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>            <span style=color:#902000>long</span> rxAddrP0 = GetAddrFromRaw(rxAddrP0Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>            <span style=color:#902000>long</span> rxAddrP1 = GetAddrFromRaw(rxAddrP1Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>            <span style=color:#902000>long</span> rxAddrP2 = GetAddrFromRaw(rxAddrP2Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>            <span style=color:#902000>long</span> rxAddrP3 = GetAddrFromRaw(rxAddrP3Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>            <span style=color:#902000>long</span> rxAddrP4 = GetAddrFromRaw(rxAddrP4Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126</span><span>            <span style=color:#902000>long</span> rxAddrP5 = GetAddrFromRaw(rxAddrP5Raw);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128</span><span>            <span style=color:#60a0b0;font-style:italic>//long txAddr = ((((rxAddrP0Raw[0] &lt;&lt; 8) + txAddrRaw[1] &lt;&lt; 8) + txAddrRaw[2] &lt;&lt; 8) + txAddrRaw[3] &lt;&lt; 8) + txAddrRaw[4];</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;RX_ADDR_P0-1 = 0x{rxAddrP0:x10} 0x{rxAddrP1:x10}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;RX_ADDR_P2-5 = 0x{rxAddrP2:x10} 0x{rxAddrP3:x10} 0x{rxAddrP4:x10} 0x{rxAddrP5:x10}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;TX_ADDR = 0x{txAddr:x10}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;EN_AA         = 0x{registers[1]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;EN_RXADDR     = 0x{registers[2]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;RF_CH         = 0x{registers[5]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;RF_SETUP      = 0x{registers[6]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;CONFIG        = 0x{registers[0]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139</span><span>            Console.WriteLine(<span style=color:#4070a0>$&#34;DYNPD/FEATURE = 0x{registers[0x1c]:x2} 0x{registers[0x1d]:x2}&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140</span><span>            Console.WriteLine(<span style=color:#4070a0>&#34;&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142</span><span>            <span style=color:#007020;font-weight:700>for</span> (<span style=color:#902000>int</span> reg = <span style=color:#40a070>0</span>; reg &lt; registers.Count; reg++)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144</span><span>                Console.Write(<span style=color:#4070a0>$&#34;Reg {reg:x2} = 0x{registers[reg]:x2}          &#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146</span><span>            Console.WriteLine(<span style=color:#4070a0>&#34;&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149</span><span>        <span style=color:#007020;font-weight:700>private</span> <span style=color:#902000>long</span> GetAddrFromRaw(<span style=color:#902000>byte</span>[] raw)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151</span><span>            <span style=color:#60a0b0;font-style:italic>//return BitConverter.ToInt64(raw, 0);</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152</span><span>            <span style=color:#007020;font-weight:700>return</span> ((<span style=color:#902000>long</span>)raw[<span style=color:#40a070>0</span>] &lt;&lt; <span style=color:#40a070>32</span>) + ((<span style=color:#902000>long</span>)raw[<span style=color:#40a070>1</span>] &lt;&lt; <span style=color:#40a070>24</span>) + ((<span style=color:#902000>long</span>)raw[<span style=color:#40a070>2</span>] &lt;&lt; <span style=color:#40a070>16</span>) + ((<span style=color:#902000>long</span>)raw[<span style=color:#40a070>3</span>] &lt;&lt; <span style=color:#40a070>8</span>) + (<span style=color:#902000>long</span>)raw[<span style=color:#40a070>4</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155</span><span>        <span style=color:#007020;font-weight:700>public</span> <span style=color:#007020;font-weight:700>void</span> Dispose()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157</span><span>            Dispose(<span style=color:#007020;font-weight:700>true</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158</span><span>            GC.SuppressFinalize(<span style=color:#007020;font-weight:700>this</span>);     
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161</span><span>        <span style=color:#007020;font-weight:700>protected</span> <span style=color:#007020;font-weight:700>virtual</span> <span style=color:#007020;font-weight:700>void</span> Dispose(<span style=color:#902000>bool</span> disposing)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163</span><span>            <span style=color:#007020;font-weight:700>if</span> (_disposed) <span style=color:#007020;font-weight:700>return</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164</span><span>            <span style=color:#007020;font-weight:700>if</span> (disposing)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165</span><span>            {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166</span><span>                senderDevice.Dispose();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169</span><span>            <span style=color:#60a0b0;font-style:italic>// Free any unmanaged objects here.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170</span><span>            _disposed = <span style=color:#007020;font-weight:700>true</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173</span><span>        ~RF24Controller()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174</span><span>        {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175</span><span>            Dispose(<span style=color:#007020;font-weight:700>false</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177</span><span>   }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178</span><span>}
</span></span></code></pre></div></details></div></article></div><aside class=sidebar><div class=sidebar-inner><section class=widget><h3>Recent posts</h3><ul class=recent-posts><li><a href=/posts/2023-02-21-picamobjectdetection1/>Camera Object Detection in Python, Part 1</a></li><li><a href=/posts/2022-12-22-hassconfigfiles/>Home Assistant REST Devices and Sensors</a></li><li><a href=/posts/2022-03-28-raspberrypihomeassistant/>Home Assistant on the Raspberry Pi</a></li><li><a href=/posts/2020-08-19-arduinolowpowerencryption/>Arduino Low Power Encryption</a></li><li><a href=/posts/2020-08-14-arduinodefaultlibraries/>Arduino Default Libraries</a></li><li><a href=/posts/2020-08-13-arduinoclassdsound/>Generating sounds on the Arduino</a></li></ul></section><section class=widget><h3>Categories</h3><ul class=category-list><li><a href=/categories/arduino/>arduino</a></li><li><a href=/categories/dotnet/>dotnet</a></li><li><a href=/categories/encryption/>encryption</a></li><li><a href=/categories/jekyll/>jekyll</a></li><li><a href=/categories/libraries/>libraries</a></li><li><a href=/categories/low/>low</a></li><li><a href=/categories/mosfet/>mosfet</a></li><li><a href=/categories/nrf24l01/>nrf24l01</a></li><li><a href=/categories/power/>power</a></li><li><a href=/categories/raspberrypi/>raspberrypi</a></li><li><a href=/categories/wav/>wav</a></li></ul></section></div></aside></div></div></main><footer class=site-footer><div class=wrapper><div class=footer-col-wrapper><div class="footer-col footer-col-left"><ul class=footer-links><li><a href=mailto:jon@codewrite.co.uk>Email</a></li><li><a href=https://github.com/codewrite target=_blank>GitHub</a></li><li><a href=https://twitter.com/codewrite target=_blank>Twitter</a></li><li><a href=/index.xml>RSS Feed</a></li></ul></div><div class="footer-col footer-col-right"><p class=footer-description>C#, Python, VueJS, C++ for Linux, Windows, Raspberry Pi and Arduino. Real Projects from a software engineer who is also an amateur radio enthusiast</p></div></div></div></footer></body></html>